!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.Splitting=t()}(this,function(){"use strict"
var e=document
function d(n,t,e){n.style.setProperty(t,e)}function s(n,t){return n.appendChild(t)}function l(n,t,e,r){var i=document.createElement("span")
return i.className=t,e&&(!r&&i.setAttribute("data-"+t,e),i.textContent=e),n&&s(n,i)||i}function p(n,t){return n&&0!=n.length?n.nodeName?[n]:[].slice.call(n[0].nodeName?n:(t||e).querySelectorAll(n)):[]}function o(n){for(var t=[];n--;)t[n]=[]
return t}function m(n,t){n&&n.some(t)}function u(t){return function(n){return t[n]}}var c={}
function n(n,t,e,r){return{by:n,depends:t,key:e,split:r}}function t(n){return function t(e,n,r){var i=r.indexOf(e)
if(-1==i)r.unshift(e),m(c[e].depends,function(n){t(n,e,r)})
else{var o=r.indexOf(n)
r.splice(i,1),r.splice(o,0,e)}return r}(n,0,[]).map(u(c))}function r(n){c[n.by]=n}function f(n,r,e,i,o){n.normalize()
var u=[],c=document.createDocumentFragment()
i&&u.push(n.previousSibling)
var a=[]
return p(n.childNodes).some(function(n){if(!n.tagName||n.hasChildNodes()){if(n.childNodes&&n.childNodes.length)return a.push(n),void u.push.apply(u,f(n,r,e,i,o))
var t=(n.wholeText||"").trim()
t.length&&m(t.split(e),function(n,t){t&&o&&a.push(l(c,"whitespace"," ",o))
var e=l(c,r,n)
u.push(e),a.push(e)})}else a.push(n)}),m(a,function(n){s(c,n)}),n.innerHTML="",s(n,c),u}var h=0,i="words",a=n(i,h,"word",function(n){return f(n,"word",/\s+/,0,1)}),g="chars",v=n(g,[i],"char",function(n,e,t){var r=[]
return m(t[i],function(n,t){r.push.apply(r,f(n,"char","",e.whitespace&&t))}),r})
function y(l){var f=(l=l||{}).key
return p(l.target||"[data-splitting]").map(function(a){var s={el:a}
return m(t(l.by||a.dataset.splitting||g),function(n){if(n.split){var t=n.by,e=(f?"-"+f:"")+n.key,r=n.split(a,l,s)
e&&(i=a,c=(u="--"+e)+"-index",m(o=r,function(n,t){Array.isArray(n)?m(n,function(n){d(n,c,t)}):d(n,c,t)}),d(i,u+"-total",o.length)),s[t]=r,a.classList.add(t)}var i,o,u,c}),a.classList.add("splitting"),s})}function w(n,t,e){var r=p(t.matching||n.children,n),i={}
return m(r,function(n){var t=Math.round(n[e])
i[t]||(i[t]=[]).push(n)}),Object.keys(i).map(Number).sort().map(u(i))}y.html=function(n){var t=(n=n||{}).target=l()
return t.innerHTML=n.content,y(n),t.outerHTML},y.add=r
var b=n("lines",[i],"line",function(n,t,e){return w(e[i],t,"offsetTop")}),N=n("items",h,"item",function(n,t){return p(t.matching||n.children,n)}),x=n("rows",h,"row",function(n,t){return w(n,t,"offsetTop")}),L=n("cols",h,"col",function(n,t){return w(n,t,"offsetLeft")}),T=n("grid",["rows","cols"]),k="layout",C=n(k,h,h,function(n,t){var e=t.rows=+(t.rows||n.dataset.rows||1),r=t.columns=+(t.columns||n.dataset.columns||1)
if(t.image=t.image||n.dataset.image||n.currentSrc||n.src,t.image){var i=p("img",n)[0]
t.image=i&&(i.currentSrc||i.src)}t.image&&d(n,"background-image","url("+t.image+")")
for(var o=e*r,u=[],c=l(h,"cell-grid");o--;){var a=l(c,"cell")
l(a,"cell-inner"),u.push(a)}return s(n,c),u}),M=n("cellRows",[k],"row",function(n,t,e){var r=t.rows,i=o(r)
return m(e[k],function(n,t,e){i[Math.floor(t/(e.length/r))].push(n)}),i}),S=n("cellColumns",[k],"col",function(n,t,e){var r=t.columns,i=o(r)
return m(e[k],function(n,t){i[t%r].push(n)}),i}),A=n("cells",["cellRows","cellColumns"],"cell",function(n,t,e){return e[k]})
return r(a),r(v),r(b),r(N),r(x),r(L),r(T),r(C),r(M),r(S),r(A),y})
