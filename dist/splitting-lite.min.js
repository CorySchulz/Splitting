!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Splitting=n()}(this,function(){"use strict"
var e=document
function f(t,n,e){t.style.setProperty(n,e)}function c(t,n){return t.appendChild(n)}function d(t,n,e,r){var i=document.createElement("span")
return i.className=n,e&&(!r&&i.setAttribute("data-"+n,e),i.textContent=e),t&&c(t,i)||i}function n(t,n){return t&&0!=t.length?t.nodeName?[t]:[].slice.call(t[0].nodeName?t:(n||e).querySelectorAll(t)):[]}function p(t,n){t&&t.some(n)}var o={}
function t(t,n,e,r){return{by:t,depends:n,key:e,split:r}}function r(t){return function n(e,t,r){var i=r.indexOf(e)
if(-1==i)r.unshift(e),p(o[e].depends,function(t){n(t,e,r)})
else{var u=r.indexOf(t)
r.splice(i,1),r.splice(u,0,e)}return r}(t,0,[]).map((n=o,function(t){return n[t]}))
var n}function i(t){o[t.by]=t}function l(t,r,e,i,u){t.normalize()
var o=[],a=document.createDocumentFragment()
i&&o.push(t.previousSibling)
var s=[]
return n(t.childNodes).some(function(t){if(!t.tagName||t.hasChildNodes()){if(t.childNodes&&t.childNodes.length)return s.push(t),void o.push.apply(o,l(t,r,e,i,u))
var n=(t.wholeText||"").trim()
n.length&&p(n.split(e),function(t,n){n&&u&&s.push(d(a,"whitespace"," ",u))
var e=d(a,r,t)
o.push(e),s.push(e)})}else s.push(t)}),p(s,function(t){c(a,t)}),t.innerHTML="",c(t,a),o}var u="words",a=t(u,0,"word",function(t){return l(t,"word",/\s+/,0,1)}),h="chars",s=t(h,[u],"char",function(t,e,n){var r=[]
return p(n[u],function(t,n){r.push.apply(r,l(t,"char","",e.whitespace&&n))}),r})
function m(d){var l=(d=d||{}).key
return n(d.target||"[data-splitting]").map(function(s){var c={el:s}
return p(r(d.by||s.dataset.splitting||h),function(t){if(t.split){var n=t.by,e=(l?"-"+l:"")+t.key,r=t.split(s,d,c)
e&&(i=s,a=(o="--"+e)+"-index",p(u=r,function(t,n){Array.isArray(t)?p(t,function(t){f(t,a,n)}):f(t,a,n)}),f(i,o+"-total",u.length)),c[n]=r,s.classList.add(n)}var i,u,o,a}),s.classList.add("splitting"),c})}return m.html=function(t){var n=(t=t||{}).target=d()
return n.innerHTML=t.content,m(t),n.outerHTML},(m.add=i)(a),i(s),m})
