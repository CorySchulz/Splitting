!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Splitting=e()}(this,function(){"use strict"
var u=document,d=u.createTextNode.bind(u)
function f(t,e,n){t.style.setProperty(e,n)}function l(t,e){return t.appendChild(e)}function p(t,e,n,r){var i=u.createElement("span")
return e&&(i.className=e),n&&(!r&&i.setAttribute("data-"+e,n),i.textContent=n),t&&l(t,i)||i}function e(t,e){return t&&0!=t.length?t.nodeName?[t]:[].slice.call(t[0].nodeName?t:(e||u).querySelectorAll(t)):[]}function h(t,e){t&&t.some(e)}var o={}
function t(t,e,n,r){return{by:t,depends:e,key:n,split:r}}function n(t){return function e(n,t,r){var i=r.indexOf(n)
if(-1==i)r.unshift(n),h(o[n].depends,function(t){e(t,n,r)})
else{var u=r.indexOf(t)
r.splice(i,1),r.splice(u,0,n)}return r}(t,0,[]).map((e=o,function(t){return e[t]}))
var e}function r(t){o[t.by]=t}function m(t,r,i,u,o){t.normalize()
var a=[],s=document.createDocumentFragment()
u&&a.push(t.previousSibling)
var c=[]
return e(t.childNodes).some(function(t){if(!t.tagName||t.hasChildNodes()){if(t.childNodes&&t.childNodes.length)return c.push(t),void a.push.apply(a,m(t,r,i,u,o))
var e=t.wholeText||"",n=e.trim()
n.length&&(" "===e[0]&&c.push(d(" ")),h(n.split(i),function(t,e){e&&o&&c.push(p(s,"whitespace"," ",o))
var n=p(s,r,t)
a.push(n),c.push(n)})," "===e[e.length-1]&&c.push(d(" ")))}else c.push(t)}),h(c,function(t){l(s,t)}),t.innerHTML="",l(t,s),a}var i="words",a=t(i,0,"word",function(t){return m(t,"word",/\s+/,0,1)}),v="chars",s=t(v,[i],"char",function(t,n,e){var r=[]
return h(e[i],function(t,e){r.push.apply(r,m(t,"char","",n.whitespace&&e))}),r})
function c(d){var l=(d=d||{}).key
return e(d.target||"[data-splitting]").map(function(s){var t,c={el:s}
return h(n(d.by||(t="splitting",s.getAttribute("data-"+t))||v),function(t){if(t.split){var e=t.by,n=(l?"-"+l:"")+t.key,r=t.split(s,d,c)
n&&(i=s,a=(o="--"+n)+"-index",h(u=r,function(t,e){Array.isArray(t)?h(t,function(t){f(t,a,e)}):f(t,a,e)}),f(i,o+"-total",u.length)),c[e]=r,s.classList.add(e)}var i,u,o,a}),s.classList.add("splitting"),c})}return c.html=function(t){t=t||{}
var e=p()
e.innerHTML=t.content
var n=t.target=e.firstElementChild
return c(t),n.outerHTML},(c.add=r)(a),r(s),c})
