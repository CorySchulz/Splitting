!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Splitting=n()}(this,function(){"use strict"
var e=document
function f(t,n,e){t.style.setProperty(n,e)}function c(t,n){return t.appendChild(n)}function s(t,n,e){var r=document.createElement("span")
return r.className=n,e&&(r.setAttribute("data-"+n,e),r.textContent=e),t&&c(t,r)||r}function p(t,n){t&&t.some(n)}var u={}
function t(t,n,e,r){return{by:t,depends:n,key:e,split:r}}function r(t){return function n(e,t,r){var i=r.indexOf(e)
if(-1==i)r.unshift(e),p(u[e].depends,function(t){n(t,e,r)})
else{var o=r.indexOf(t)
r.splice(i,1),r.splice(o,0,e)}return r}(t,0,[]).map((n=u,function(t){return n[t]}))
var n}function n(t){u[t.by]=t}function d(t,e,r,i,o){t.normalize()
var u=[],a=document.createDocumentFragment()
return i&&u.push(t.previousSibling),t.childNodes.forEach(function(t){if(t&&t.childNodes&&t.childNodes.length)return c(a,t),void u.push.apply(u,d(t,e,r,i,o))
var n=(t.wholeText||"").trim()
n.length?p(n.split(r),function(t,n){n&&o&&s(a,e," "),u.push(s(a,e,t))}):c(a,t)}),t.innerHTML="",c(t,a),u}var i="words",o=t(i,0,"word",function(t){return d(t,"word",/\s+/,0,1)}),a="chars",l=t(a,[i],"char",function(t,e,n){var r=[]
return p(n[i],function(t,n){r.push.apply(r,d(t,"char","",e.whitespace&&n))}),r})
function h(d){var t,n,l=(d=d||{}).key
return(t=d.target||"[data-splitting]",t&&0!=t.length?t.nodeName?[t]:[].slice.call(t[0].nodeName?t:(n||e).querySelectorAll(t)):[]).map(function(c){var s={el:c}
return p(r(d.by||c.dataset.splitting||a),function(t){if(t.split){var n=t.by,e=n+(l?"-"+l:""),r=t.split(c,d,s)
e&&(i=c,a=(u="--"+e)+"-index",p(o=r,function(t,n){Array.isArray(t)?p(t,function(t){f(t,a,n)}):f(t,a,n)}),f(i,u+"-total",o.length)),s[n]=r,c.classList.add(n)}var i,o,u,a}),c.classList.add("splitting"),s})}return h.html=function(t){var n=(t=t||{}).target=s()
return n.innerHTML=t.content,h(t),n.outerHTML},(h.add=n)(o),n(l),h})
